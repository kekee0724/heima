<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="cn.bipark.reco.upms.model.mapper.BiRecordMapper">
	
	<sql id="RecordWhere">
		<where>	      				
	       <if test="@Ognl@isNotEmpty(userId)">
				AND t.user_id = #{userId}
			</if>
	       <if test="@Ognl@isNotEmpty(levelId)">
				AND t.level_id = #{levelId}
			</if>
	       <if test="@Ognl@isNotEmpty(pass)">
				AND t.pass = #{pass}
			</if>
	       <if test="@Ognl@isNotEmpty(correctRate)">
				AND t.correct_rate = #{correctRate}
			</if>
	       <if test="@Ognl@isNotEmpty(score)">
				AND t.score = #{score}
			</if>
	       <if test="@Ognl@isNotEmpty(details)">
				AND t.details = #{details}
			</if>
	       <if test="@Ognl@isNotEmpty(startTimeBegin)">
				AND t.start_time >= #{startTimeBegin}
		   </if>
		   <if test="@Ognl@isNotEmpty(startTimeEnd)">
				AND t.start_time &lt;= #{startTimeEnd}
		   </if>
	       <if test="@Ognl@isNotEmpty(levelTime)">
				AND t.level_time = #{levelTime}
			</if>
	       <if test="@Ognl@isNotEmpty(retainTime)">
				AND t.retain_time = #{retainTime}
			</if>
	       <if test="@Ognl@isNotEmpty(curQuestion)">
				AND t.cur_question = #{curQuestion}
			</if>
	       <if test="@Ognl@isNotEmpty(status)">
				AND t.status = #{status}
			</if>
	       <if test="@Ognl@isNotEmpty(gmtCreateTimeBegin)">
				AND t.gmt_create_time >= #{gmtCreateTimeBegin}
		   </if>
		   <if test="@Ognl@isNotEmpty(gmtCreateTimeEnd)">
				AND t.gmt_create_time &lt;= #{gmtCreateTimeEnd}
		   </if>
	       <if test="@Ognl@isNotEmpty(gmtCreate)">
				AND t.gmt_create = #{gmtCreate}
			</if>
	       <if test="@Ognl@isNotEmpty(gmtUpdateTimeBegin)">
				AND t.gmt_update_time >= #{gmtUpdateTimeBegin}
		   </if>
		   <if test="@Ognl@isNotEmpty(gmtUpdateTimeEnd)">
				AND t.gmt_update_time &lt;= #{gmtUpdateTimeEnd}
		   </if>
	       <if test="@Ognl@isNotEmpty(gmtUpdate)">
				AND t.gmt_update = #{gmtUpdate}
			</if>
		</where>
	</sql>

    <select id="findBy" resultType="cn.bipark.reco.upms.model.viewmodel.list.RecordListVM">
    	SELECT 
			t.id				id,
			t.user_id				userId,
			t.level_id				levelId,
			t.pass				pass,
			t.correct_rate				correctRate,
			t.score				score,
			t.details				details,
			t.start_time				startTime,
			t.level_time				levelTime,
			t.retain_time				retainTime,
			t.cur_question				curQuestion,
			t.status				status,
			t.gmt_create_time				gmtCreateTime,
			t.gmt_create				gmtCreate,
			t.gmt_update_time				gmtUpdateTime,
			t.gmt_update				gmtUpdate
	    FROM bi_record t 
		<include refid="RecordWhere"/>		
		<if test="@Ognl@isNotEmpty(orderBy)">
			ORDER BY ${orderBy}
		</if>
    </select>
	
</mapper>

